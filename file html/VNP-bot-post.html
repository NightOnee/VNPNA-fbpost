<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-85N4WR4EB7"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-85N4WR4EB7');
	</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìÆ Tr·ª£ l√Ω S√°ng t·∫°o N·ªôi dung Vietnam Post</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- **UPDATED**: Load API Key from the external config.js file -->
    <!-- This file MUST be in the same directory as this HTML file. -->
    <script src="config.js"></script>

    <style>
        /* Custom styles to enhance Tailwind */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc; /* gray-100 */
        }
        .container-card {
            background-color: white;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); /* shadow-md */
            padding: 1.5rem; /* p-6 */
        }
        .btn-primary {
            background-color: #2563eb; /* blue-600 */
            color: white;
            font-weight: 600;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem; /* rounded-lg */
            transition: background-color 0.2s;
        }
        .btn-primary:hover:not(:disabled) {
            background-color: #1d4ed8; /* blue-700 */
        }
        .btn-primary:disabled {
            background-color: #9ca3af; /* gray-400 */
            cursor: not-allowed;
        }
        .btn-secondary {
            background-color: #e5e7eb; /* gray-200 */
            color: #1f2937; /* gray-800 */
            font-weight: 600;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem; /* rounded-lg */
            transition: background-color 0.2s;
        }
        .btn-secondary:hover {
            background-color: #d1d5db; /* gray-300 */
        }
        .form-input, .form-textarea {
            width: 100%;
            border: 1px solid #d1d5db; /* gray-300 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 0.75rem;
        }
        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: #2563eb; /* blue-600 */
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2);
        }
        .result-content {
            white-space: pre-wrap;
            word-wrap: break-word;
            background-color: #f9fafb; /* gray-50 */
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #e5e7eb; /* gray-200 */
            line-height: 1.6;
            color: #111827; /* gray-900 */
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div class="max-w-3xl mx-auto p-4 sm:p-6 lg:p-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">üìÆ Tr·ª£ l√Ω S√°ng t·∫°o N·ªôi dung Vietnam Post</h1>
            <p class="mt-2 text-lg text-gray-600">Ch·ªâ c·∫ßn ƒëi·ªÅn 3 th√¥ng tin d∆∞·ªõi ƒë√¢y, AI s·∫Ω gi√∫p b·∫°n t·∫°o ra m·ªôt b√†i vi·∫øt Facebook ho√†n ch·ªânh!</p>
        </header>

        <!-- Alert Box -->
        <div id="alert-box" class="mb-6"></div>

        <!-- Input Form -->
        <div class="container-card mb-8">
            <h2 class="text-xl font-semibold text-gray-900 mb-6 border-b pb-3">1. Cung c·∫•p th√¥ng tin c·∫ßn thi·∫øt</h2>
            <div class="space-y-6">
                <!-- **REMOVED**: API Key input field is no longer needed -->
                <div>
                    <label for="san-pham-input" class="block text-md font-medium text-gray-700 mb-2">S·∫£n ph·∫©m/D·ªãch v·ª• c·ªët l√µi:</label>
                    <input type="text" id="san-pham-input" class="form-input" placeholder="V√≠ d·ª•: B·∫£o hi·ªÉm xe m√°y PTI, Chuy·ªÉn ph√°t nhanh EMS...">
                </div>
                <div>
                    <label for="diem-nhan-input" class="block text-md font-medium text-gray-700 mb-2">C√°c ƒëi·ªÉm nh·∫•n ho·∫∑c th√¥ng tin quan tr·ªçng kh√°c: <span class="text-gray-500 font-normal">(Kh√¥ng b·∫Øt bu·ªôc)</span></label>
                    <textarea id="diem-nhan-input" class="form-textarea" rows="4" placeholder="V√≠ d·ª•: Ch∆∞∆°ng tr√¨nh gi·∫£m gi√° 20%, Mi·ªÖn ph√≠ t·∫°o t√†i kho·∫£n..."></textarea>
                </div>
                <div>
                    <label for="lien-he-input" class="block text-md font-medium text-gray-700 mb-2">Th√¥ng tin li√™n h·ªá:</label>
                    <input type="text" id="lien-he-input" class="form-input" placeholder="V√≠ d·ª•: 0988.888.888 - Nguy·ªÖn VƒÉn A - B∆∞u c·ª•c ABC">
                </div>
            </div>
            <div class="mt-8">
                <button id="generate-btn" class="w-full btn-primary flex items-center justify-center space-x-2">
                    <span>T·∫°o b√†i vi·∫øt ‚ú®</span>
                </button>
                <div id="spinner" class="hidden text-center mt-4 text-gray-600 font-medium">
                    <svg class="animate-spin h-5 w-5 text-blue-600 inline-block mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Chuy√™n gia ƒëang s√°ng t·∫°o, vui l√≤ng ch·ªù trong gi√¢y l√°t... ‚úçÔ∏è
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results-container" class="hidden container-card">
            <h2 class="text-xl font-semibold text-gray-900 mb-4 border-b pb-3">2. K·∫øt qu·∫£</h2>
            <div id="result-display" class="result-content mb-6"></div>
            
            <h2 class="text-xl font-semibold text-gray-900 mb-4 border-b pb-3">3. Thao t√°c</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                 <button id="copy-btn" class="w-full btn-secondary flex items-center justify-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    <span>Sao ch√©p</span>
                </button>
                <button id="regenerate-btn" class="w-full btn-secondary flex items-center justify-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
                    <span>T·∫°o l·∫°i</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- SECTION 1: CONFIGURATION AND DATA ---

        const MUC_DICH_OPTIONS = {
            1: "Gi·ªõi thi·ªáu v√† l√†m r√µ l·ª£i √≠ch c·ªßa d·ªãch v·ª• cho kh√°ch h√†ng ch∆∞a bi·∫øt.",
            2: "TƒÉng c∆∞·ªùng t∆∞∆°ng t√°c (like, comment, share) v√† x√¢y d·ª±ng c·ªông ƒë·ªìng.",
            3: "K√™u g·ªçi h√†nh ƒë·ªông c·ª• th·ªÉ (v√≠ d·ª•: t·∫£i app, ƒë·∫øn b∆∞u c·ª•c g·∫ßn nh·∫•t, ƒëƒÉng k√Ω d·ªãch v·ª•).",
            4: "X√¢y d·ª±ng h√¨nh ·∫£nh th∆∞∆°ng hi·ªáu B∆∞u ƒëi·ªán g·∫ßn g≈©i, ƒë√°ng tin c·∫≠y.",
            5: "Chia s·∫ª c√¢u chuy·ªán th√†nh c√¥ng c·ªßa kh√°ch h√†ng (case study/testimonial) ƒë·ªÉ tƒÉng uy t√≠n.",
            6: "Gi·∫£i ƒë√°p th·∫Øc m·∫Øc th∆∞·ªùng g·∫∑p v√† cung c·∫•p c√°c m·∫πo h·ªØu √≠ch cho kh√°ch h√†ng.",
        };

        const GIONG_VAN_OPTIONS = {
            1: "Chuy√™n nghi·ªáp & ƒê√°ng tin c·∫≠y: Nh·∫•n m·∫°nh v√†o s·ª± an to√†n, quy tr√¨nh r√µ r√†ng, minh b·∫°ch.",
            2: "Th√¢n thi·ªán & G·∫ßn g≈©i: D√πng ng√¥n t·ª´ ƒë∆°n gi·∫£n, d·ªÖ hi·ªÉu, nh∆∞ m·ªôt ng∆∞·ªùi b·∫°n.",
            3: "Vui v·∫ª & B·∫Øt trend: S·ª≠ d·ª•ng c√°c t·ª´ ng·ªØ, c·∫•u tr√∫c c√¢u ƒëang th·ªãnh h√†nh.",
            4: "Truy·ªÅn c·∫£m h·ª©ng & K·ªÉ chuy·ªán: Chia s·∫ª m·ªôt c√¢u chuy·ªán √Ω nghƒ©a.",
            5: "ƒê·ªìng c·∫£m & Th·∫•u hi·ªÉu: T·∫≠p trung v√†o vi·ªác gi·∫£i quy·∫øt c√°c n·ªói lo c·ªßa kh√°ch h√†ng.",
            6: "Chia s·∫ª ki·∫øn th·ª©c & H∆∞·ªõng d·∫´n: Cung c·∫•p th√¥ng tin h·ªØu √≠ch, m·∫πo v·∫∑t.",
        };

        const MASTER_PROMPT_TEMPLATE = `
# B·ªêI C·∫¢NH V√Ä VAI TR√í
B·∫†N L√Ä: M·ªôt chuy√™n gia s√°ng t·∫°o n·ªôi dung Social Media, am hi·ªÉu s√¢u s·∫Øc v·ªÅ th·ªã tr∆∞·ªùng Vi·ªát Nam v√† c√≥ chuy√™n m√¥n v·ªÅ c√°c s·∫£n ph·∫©m, d·ªãch v·ª• c·ªßa B∆∞u ƒëi·ªán Vi·ªát Nam (Vietnam Post).
M·ª§C TI√äU C·ª¶A B·∫†N: Gi√∫p t√¥i, m·ªôt nh√¢n vi√™n B∆∞u ƒëi·ªán, t·∫°o ra m·ªôt b√†i vi·∫øt ƒëƒÉng tr√™n Facebook th·∫≠t h·∫•p d·∫´n, chuy√™n nghi·ªáp v√† hi·ªáu qu·∫£ d·ª±a tr√™n c√°c th√¥ng tin t√¥i cung c·∫•p d∆∞·ªõi ƒë√¢y.

# TH√îNG TIN CHI TI·∫æT V·ªÄ B√ÄI VI·∫æT
D∆∞·ªõi ƒë√¢y l√† c√°c th√¥ng tin c·∫ßn thi·∫øt, h√£y d·ª±a v√†o ƒë√¢y ƒë·ªÉ t·∫°o b√†i vi·∫øt:

**1. S·∫£n ph·∫©m/D·ªãch v·ª• c·ªët l√µi:**
{san_pham}

**2. M·ª•c ƒë√≠ch ch√≠nh c·ªßa b√†i vi·∫øt:**
{muc_dich}

**3. Gi·ªçng vƒÉn mong mu·ªën:**
{giong_van}

**4. C√°c ƒëi·ªÉm nh·∫•n ho·∫∑c th√¥ng tin quan tr·ªçng kh√°c:**
{diem_nhan}

# Y√äU C·∫¶U V·ªÄ ƒê·ªäNH D·∫†NG ƒê·∫¶U RA
- **K·∫øt qu·∫£ cu·ªëi c√πng:** Ph·∫£i l√† M·ªòT b√†i vi·∫øt ho√†n ch·ªânh, li·ªÅn m·∫°ch, s·∫µn s√†ng ƒë·ªÉ sao ch√©p v√† ƒëƒÉng tr·ª±c ti·∫øp l√™n Facebook.
- **C·∫•u tr√∫c:** B√†i vi·∫øt ph·∫£i c√≥ 3 ph·∫ßn r√µ r√†ng:
    1.  **C√¢u M·ªü ƒê·∫ßu (Hook):** Ph·∫£i th·∫≠t ·∫•n t∆∞·ª£ng, thu h√∫t s·ª± ch√∫ √Ω trong 3 gi√¢y ƒë·∫ßu ti√™n (c√≥ th·ªÉ l√† c√¢u h·ªèi, m·ªôt s·ª± th·∫≠t g√¢y ng·∫°c nhi√™n, ho·∫∑c m·ªôt v·∫•n ƒë·ªÅ m√† kh√°ch h√†ng ƒëang g·∫∑p).
    2.  **N·ªôi dung ch√≠nh:** Di·ªÖn gi·∫£i c√°c l·ª£i √≠ch m·ªôt c√°ch r√µ r√†ng, d·ªÖ hi·ªÉu. S·ª≠ d·ª•ng icon (bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c) m·ªôt c√°ch tinh t·∫ø ƒë·ªÉ tƒÉng t√≠nh sinh ƒë·ªông v√† ph√¢n t√°ch c√°c √Ω. C√≥ th·ªÉ d√πng g·∫°ch ƒë·∫ßu d√≤ng/ƒë√°nh s·ªë ƒë·ªÉ li·ªát k√™.
    3.  **K√™u G·ªçi H√†nh ƒê·ªông (Call-to-Action):** Ph·∫£i th·∫≠t r√µ r√†ng v√† th√¥i th√∫c.
- **TUY·ªÜT ƒê·ªêI KH√îNG** ƒë∆∞·ª£c ch·ª©a c√°c ti√™u ƒë·ªÅ ph√¢n m·ª•c nh∆∞ "C√¢u M·ªü ƒê·∫ßu (Hook):", "N·ªôi dung ch√≠nh:", "K√™u g·ªçi h√†nh ƒë·ªông:".
- **Hashtag:** **B·∫ÆT BU·ªòC** c√≥ hashtag #VNP, ƒë·ªÅ xu·∫•t th√™m 3-4 hashtag ph√π h·ª£p, bao g·ªìm hashtag th∆∞∆°ng hi·ªáu, hashtag d·ªãch v·ª• v√† hashtag xu h∆∞·ªõng (n·∫øu c√≥).
- **B·∫ÆT BU·ªòC** trong ph·∫ßn "3. **K√™u G·ªçi H√†nh ƒê·ªông (Call-to-Action):**" ph·∫£i k·∫øt h·ª£p th√™m th√¥ng tin li√™n h·ªá sau: {thong_tin_lien_he}
`;

        // --- SECTION 2: DOM ELEMENTS AND LOGIC ---

        // Get DOM elements
        const generateBtn = document.getElementById('generate-btn');
        const regenerateBtn = document.getElementById('regenerate-btn');
        const copyBtn = document.getElementById('copy-btn');
        const sanPhamInput = document.getElementById('san-pham-input');
        const diemNhanInput = document.getElementById('diem-nhan-input');
        const lienHeInput = document.getElementById('lien-he-input');
        const spinner = document.getElementById('spinner');
        const alertBox = document.getElementById('alert-box');
        const resultsContainer = document.getElementById('results-container');
        const resultDisplay = document.getElementById('result-display');
        
        let generatedText = "";

        // Attach event listeners
        generateBtn.addEventListener('click', handleGeneratePost);
        regenerateBtn.addEventListener('click', handleGeneratePost);
        copyBtn.addEventListener('click', copyToClipboard);

        /**
         * Main function to handle post generation
         */
        async function handleGeneratePost() {
            // **UPDATED**: Get API Key from the global variable defined in config.js
            const apiKey = window.API_KEY; 
            
            // Get other values from input fields
            const sanPham = sanPhamInput.value.trim();
            const diemNhan = diemNhanInput.value.trim();
            const lienHe = lienHeInput.value.trim();

            // **UPDATED**: Validate the API Key from config.js
            if (typeof apiKey === 'undefined' || !apiKey || apiKey === "YOUR_API_KEY_HERE") {
                showAlert("Kh√¥ng t√¨m th·∫•y API Key ho·∫∑c API Key kh√¥ng h·ª£p l·ªá. Vui l√≤ng ki·ªÉm tra l·∫°i file `config.js` c·ªßa b·∫°n.", "error");
                return;
            }
            if (!sanPham || !lienHe) {
                showAlert("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin 'S·∫£n ph·∫©m/D·ªãch v·ª•' v√† 'Th√¥ng tin li√™n h·ªá'.", "warning");
                return;
            }

            // Show spinner and disable buttons
            setLoadingState(true);

            try {
                // Randomly select purpose and tone
                const randomMucDich = getRandomValue(MUC_DICH_OPTIONS);
                const randomGiongVan = getRandomValue(GIONG_VAN_OPTIONS);

                // Format the final prompt
                let finalPrompt = MASTER_PROMPT_TEMPLATE
                    .replace('{san_pham}', sanPham)
                    .replace('{muc_dich}', randomMucDich)
                    .replace('{giong_van}', randomGiongVan)
                    .replace('{diem_nhan}', diemNhan || "Kh√¥ng c√≥")
                    .replace('{thong_tin_lien_he}', lienHe);

                // Prepare the API call
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                const payload = {
                    contents: [{ parts: [{ text: finalPrompt }] }]
                };

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error.message || `L·ªói HTTP: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.candidates && data.candidates[0].content && data.candidates[0].content.parts[0]) {
                    generatedText = data.candidates[0].content.parts[0].text;
                    displayResults(generatedText);
                } else {
                    let safetyMessage = "Kh√¥ng nh·∫≠n ƒë∆∞·ª£c n·ªôi dung t·ª´ AI. L√Ω do c√≥ th·ªÉ l√† prompt c·ªßa b·∫°n ƒë√£ vi ph·∫°m ch√≠nh s√°ch an to√†n.";
                    if (data.promptFeedback && data.promptFeedback.blockReason) {
                        safetyMessage += ` (L√Ω do: ${data.promptFeedback.blockReason})`;
                    }
                    throw new Error(safetyMessage);
                }

            } catch (error) {
                showAlert(`ƒê√£ c√≥ l·ªói x·∫£y ra khi t·∫°o b√†i vi·∫øt: ${error.message}`, "error");
                resultsContainer.classList.add('hidden');
            } finally {
                // Hide spinner and re-enable buttons
                setLoadingState(false);
            }
        }
        
        /**
         * Displays the generated results on the page
         * @param {string} text The text to display
         */
        function displayResults(text) {
            resultDisplay.textContent = text;
            resultsContainer.classList.remove('hidden');
            // Scroll to the results for better UX
            resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        /**
         * Shows an alert message to the user
         * @param {string} message The message to show
         * @param {'warning' | 'error' | 'success'} type The type of alert
         */
        function showAlert(message, type = 'warning') {
            const alertColors = {
                warning: 'bg-yellow-100 border-yellow-400 text-yellow-800',
                error: 'bg-red-100 border-red-400 text-red-800',
                success: 'bg-green-100 border-green-400 text-green-800'
            };
            alertBox.innerHTML = `<div class="p-4 border-l-4 ${alertColors[type]}" role="alert">
                <p class="font-bold">${type.charAt(0).toUpperCase() + type.slice(1)}</p>
                <p>${message}</p>
            </div>`;
        }
        
        /**
         * Toggles the loading state of the UI
         * @param {boolean} isLoading Whether the app is loading
         */
        function setLoadingState(isLoading) {
            if (isLoading) {
                spinner.classList.remove('hidden');
                alertBox.innerHTML = '';
                generateBtn.disabled = true;
                regenerateBtn.disabled = true;
            } else {
                spinner.classList.add('hidden');
                generateBtn.disabled = false;
                regenerateBtn.disabled = false;
            }
        }

        /**
         * Gets a random value from an object
         * @param {object} obj The object to get a random value from
         */
        function getRandomValue(obj) {
            const values = Object.values(obj);
            const randomIndex = Math.floor(Math.random() * values.length);
            return values[randomIndex];
        }
        
        /**
         * Copies the generated text to the clipboard
         */
        function copyToClipboard() {
            if (!generatedText) return;

            if (navigator.clipboard) {
                navigator.clipboard.writeText(generatedText).then(() => {
                    const originalText = copyBtn.querySelector('span').textContent;
                    copyBtn.querySelector('span').textContent = '‚úÖ ƒê√£ sao ch√©p!';
                    setTimeout(() => {
                        copyBtn.querySelector('span').textContent = originalText;
                    }, 2000);
                }).catch(err => {
                    showAlert('Kh√¥ng th·ªÉ sao ch√©p t·ª± ƒë·ªông. Vui l√≤ng sao ch√©p th·ªß c√¥ng.', 'error');
                });
            } else {
                try {
                    const textArea = document.createElement("textarea");
                    textArea.value = generatedText;
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    const originalText = copyBtn.querySelector('span').textContent;
                    copyBtn.querySelector('span').textContent = '‚úÖ ƒê√£ sao ch√©p!';
                    setTimeout(() => {
                        copyBtn.querySelector('span').textContent = originalText;
                    }, 2000);
                } catch (err) {
                     showAlert('Kh√¥ng th·ªÉ sao ch√©p. Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£.', 'error');
                }
            }
        }
    </script>
</body>
</html>
